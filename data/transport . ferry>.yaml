index:
  ic√¥nes: ‚õ¥

d√©part:
  note: Variable remplie par une interface de recherche.
arriv√©e:
  note: Variable remplie par une interface de recherche.

vitesse:
  ic√¥nes: ‚åö
  question: Quelle est la vitesse du ferry ?
  formule: vitesse en kmh / km par mille nautique
  unit√©: noeud
  suggestions:
    lente: 12 noeud
    rapide: 18 noeud
    tr√®s rapide: 27 noeud

vitesse en kmh:
  formule: distance aller / dur√©e du voyage . r√©elle
  par d√©faut: vitesse moyenne . m√©trique

vitesse trop √©lev√©e:
  type: notification
  s√©v√©rit√©: avertissement
  formule: vitesse en kmh > 100
  description: |
    Votre vitesse est irr√©aliste. Il s'agit d'un bateau, pas d'un avion. 

    C'est peut-√™tre une erreur de saisie : v√©rifiez la dur√©e du voyage, ou une confusion dans votre port d'arriv√©e ?

empreinte du voyage:
  titre: Un voyage en ferry (aller‚Äëretour)
  ic√¥nes: ‚õ¥
  expos√©:
    titre: Calculateur d'empreinte carbone du ferry
    description: D√©couvrez une estimation de l'empreinte climat du ferry en fonction de votre voyage et des options de votre travers√©e.
    image: https://futur.eco/images/ferry.png
    exemples via suggestions: transport . ferry . distance aller . orthodromique
  formule: distance aller retour * empreinte par km volume
  unit√©: kgCO‚ÇÇe

dur√©e du voyage:
  question: Quelle est la dur√©e de votre travers√©e ?
  description: |
    Indiquez votre heure de d√©part et d'arriv√©e, en s√©lectionnant bien le jour d'arriv√©e.

    ‚ö†Ô∏è  La vitesse est cruciale pour calculer l'empreinte du voyage, car la consommation d'essence varie au cube de la vitesse.
  note: On parle de la dur√©e du voyage calcul√©e avec les heures de d√©part sur le billet, qui n'est donc pas la dur√©e de navigation r√©elle.
  ic√¥nes: ‚è≥Ô∏è
  unit√©: h
  suggestions:
    une demi-journ√©e: 6 h
    une nuit: 12 h
    24h: 24 h

dur√©e du voyage . r√©elle:
  formule:
    variations:
      - si: dur√©e du voyage < 3
        alors: dur√©e du voyage * 0.8
      - sinon: dur√©e du voyage - 1
  description: |
    Nous consid√©rons que pour un d√©part √† 19h sur le billet, et une arriv√©e √† 7h, pour le calcul de la vitesse la travers√©e n'a pas dur√© 12h de navigation mais 11h, car il y a 30 minutes avant que le ferry se lance puis 30 minutes de d√©barquement. Cela peut √©videmment varier en fonction des compagnies et du type de billet (embarquement pi√©ton ou avec voiture), mais c'est un ordre de grandeur.

    Pour les travers√©es courtes de moins de 3h, nous retirons 10% du temps (par convention √©galement), soit 20 minutes * 2 pour 3h par exemple.

distance aller retour: 2 * distance aller
distance aller:
  formule: orthodromique * 1.3
  description: |
    Nous ne calculons pas encore les distances r√©elles travers√©es par les bateaux. Ainsi, l'ajout d'un facteur 30% permet de s'en rapprocher. 
    Si vous avez acc√®s √† un facteur moyen sourc√©, n'h√©sitez pas √† intervenir.

distance importante:
  type: notification
  s√©v√©rit√©: information
  formule: distance aller > 1000
  description: |
    Le mod√®le de calcul est bas√© sur un ferry mediterran√©en r√©alisant des travers√©es de 300km au maximum. 

    Prenez donc le r√©sultat sur de longues travers√©es, en particulier sur un cargo, avec des pincettes en attendant une am√©lioration du mod√®le d√©di√©e √† ce genre de travers√©es.

distance aller . orthodromique:
  ic√¥nes: üó∫Ô∏è
  question: Quel est votre trajet ?
  description: |
    Saisissez la ville de d√©part et d'arriv√©e d'un vrai trajet en ferry.

    Nous ne g√©rons pas encore l'estimation de l'empreinte climat d'un trajet multimodal (TGV + ferry par exemple).
  note: L'utilisateur saisit les ports de d√©part et d'arriv√©e, nous r√©cup√©rons leurs coordonn√©es et calculons la distance orthodromique, ce qui consiste √† prendre en compte le fait que la terre n'est pas plate.
  par d√©faut: 320 km
  unit√©: km
  suggestions:
    üá¨üáß Cherbourg‚ÜîPoole: 130
    üèùÔ∏è Marseille‚ÜîAjaccio: 350
    üá©üáø Marseille‚ÜîAlger: 800

empreinte totale:
  formule: facteur vitesse * correction temps de navigation * empreinte totale moyenne

empreinte totale . par km: empreinte totale / km par mille nautique

facteur vitesse:
  formule: rapport vitesse * rapport vitesse * rapport vitesse
  description: On prend l'hypoth√®se d'une √©volution au cube de la puissance en fonction de la vitesse.

rapport vitesse: vitesse / vitesse moyenne

correction temps de navigation:
  formule: vitesse moyenne / vitesse
  description: |
    La puissance n√©cessaire pour faire avancer le navire √©volue au cube de la vitesse. L'empreinte climat par heure suite naturellement cette m√™me fonction. Mais le navire va alors plus vite : il va √©mettre plus √† l'heure pendant moins de temps, ce facteur corrige le tir pour.

empreinte totale moyenne:
  formule: 576.48 kgCO2e/mn
  note: |
    Donn√©es greenferries 2020 tir√©es de Thetis-MRV 2020 https://mrv.emsa.europa.eu/#public/emission-report
vitesse moyenne:
  formule: m√©trique / km par mille nautique
  unit√©: noeud

vitesse moyenne . m√©trique:
  titre: Vitesse moyenne ferry
  formule: 33 km/h
  note: |
    On consid√®re la vitesse moyenne du Mega Express Four de Corsica Ferries
    Donn√©es greenferries 2019 tir√©es de Thetis-MRV 2019 https://www.greenferries.org/ships/mega-express-four-9086590/

empreinte totale moyenne . par km: empreinte totale moyenne / km par mille nautique

empreinte du bateau:
  titre: Empreinte du bateau t√©moin par km
  description: Nous utilisons ici comme bateau t√©moin M√©ga Express Four de la flotte Corsica Ferries. Ils est repr√©sentatif des gros ferries de max ~2000 passagers, rapides.
  formule: empreinte totale . par km
  unit√©: kgCO2e/km

empreinte par km volume:
  titre: Empreinte par km et passager
  formule: empreinte du bateau * part du volume
  description: |
    Voici notre objectif : estimer l'empreinte d'un passager sur les ferries de voyage comme ceux qui relient la m√©tropole √† la Corse et √† l'Angleterre.

    Le ferry est souvent propos√© comme alternative s√©rieuse √† l‚Äôavion du point de vue de l'empreinte carbone, mais il n‚Äôexistait pourtant aucune estimation de son empreinte climat au kilom√®tre (ni ADEME en France, ni √† l‚Äôinternational, ni dans la litt√©rature scientifique) qui prenne en compte non pas un passager moyen, mais la diversit√© des options d'un billet : 

    - passager en voiture ou non
    - passager en cabine, en si√®ge, ou au sol
    - √©quipement loisir du bateau : restaurant, bar, piscine, grand couloirs, etc.
    - le fret embarqu√© dans les camions
    - % de remplissage du bateau
    - vitesse
    - etc

    Nous savons combien un ferry donn√© √©met de gaz √† effet de serre (GES) : il suffit en somme de multipler sa consommation de fioul par le ou les facteurs d'√©mission CO2e du fioul et autres carburants utilis√©s. Mais la difficult√© est ensuite d'attribuer une part de ces GES au passager √† pied, au passager seul dans sa voiture qui profite d'un lounge VIP, et au transport de marchandises, etc. 

    Le principe de calcul adopt√© ici est simple : nous attribuons une empreinte selon le volume que le billet achet√© par le voyageur et les choix de consommation faits √† bord occupent sur le bateau. 

    Voici la [note de m√©thode](https://hackmd.io/@laem/empreinte-ferry) (~20 pages) qui explique le probl√®me qu'on veut r√©soudre et les possibilit√©s pour faire le calcul, mais qui reste th√©orique.

    Ensuite, concr√®tement, vous pouvez parcourir ci-dessous de fa√ßon int√©ractive et compl√®te le calcul du facteur d'√©mission dynamique juste ci-dessous ‚¨áÔ∏è.

    Finalement, n'h√©sitez pas √† faire des propositions de modification du mod√®le, soit via une pull request sur [github](https://github.com/laem/futureco/blob/master/source/sites/publicodes/ferry/index.yaml) soit via un simple commentaire sur [ce ticket](https://github.com/laem/futureco/issues/123).

    En pratique, nous le faisons sur le bateau type Mega Express Four tout simplement car nous en disposons des plans assez d√©taill√©s. Le travail devrait √™tre fait pour d'autres navires par la suite.
    
    ![Le Mega Express Four en navigation sur la Mediterran√©e](https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/02_Corsica_Ferries_Mega_Express_Four_\(cropped\).jpg/640px-02_Corsica_Ferries_Mega_Express_Four_\(cropped\).jpg)
    *[Plus d'infos sur le Mega Express Four](https://fr.wikipedia.org/wiki/Mega_Express_Four)*

    Le calcul des diff√©rentes surfaces est issu d'[un dessin SVG](https://futur.eco/ferry/surface-mega-express-four) sur un plan des ponts du navire, qui nous permet ensuite d'en d√©duire les volumes, et qui est donc une des clefs du calcul. 

    ### Limites du calcul

    Un biais √† noter serait la non exactitude de ce plan du ferry et des mesures qui y sont faites. Il parait cependant assez fiable pour un ordre de grandeur, ce qui est notre but ici.

    Un autre biais est √©videmment le choix de ce qui est comptabilis√© comme surface utile ou non. Nous avons par exemple exclu les ponts √† l'air libre, sauf la piscine et les bars ext√©rieurs.
    √âvidemment, le calcul n'est donc applicable strictement qu'√† ce bateau, mais nous faisons le choix de l'extrapoler comme un bateau type faute d'avoir les ressources pour mod√©liser chaque bateau commercial.

    Voir √©galement ce [ticket](https://github.com/laem/futureco/issues/123) pour lire et contribuer aux limites du calcul.

  unit√©: kgCO2e/km

part du volume:
  titre: Part du volume utile du bateau attribu√©e au passager
  formule: volume passager / volume utile

volume passager:
  note: |
    Pour les cabines, les si√®ges et les garages, nous ne pouvons pas supposer qu'ils sont aussi peu remplis que l'indicateur "passagers" nous donne (1/3). 

    En effet, nous supposons que le nombre max de passager est tr√®s √©lev√© car on peut faire rentrer un tas de gens pour des travers√©es de jour. 

    La moyenne de remplissage de ces trois autres espaces doit davantage s'approcher d'un 2/3 avec une politique de prix au yield aggressive pour les places restantes. 

    ‚ö†Ô∏è C'est peut-√™tre une hypoth√®se trop favorable qui pourrait donner lieu √† une sous-estimation de 30% voir 100%.
  formule:
    somme:
      - cabine partag√©e
      - loisirs
      - si√®ge
      - voiture
      - communs

volume passager . communs:
  formule: volume communs / passagers
volume passager . loisirs:
  applicable si: consommation de services
  formule: surface . loisirs * hauteur pont bas / passagers

volume passager . si√®ge:
  non applicable si: cabine
  titre: Un si√®ge dans un dortoir
  formule: hauteur pont bas * surface . si√®ge

volume passager . voiture:
  applicable si: voiture
  formule: major√© / groupe
  note: |
    Ici nous d√©cidons de ne pas voir la capacit√© en voiture et diviser la surface voiture par ce nombre, car les diff√©rentes zones de garage peuvent accomoder aussi bien des voitures que des camions.

volume passager . voiture . major√©:
  titre: Volume garage voiture
  formule: largeur * longueur * hauteur moyenne garage
  unit√©: m3
  note: Nous partons du principe que certaines voitures se garent dans un garage dont la hauteur du pont haut, donc appliquons la moyenne pond√©r√©e par la surface.
volume passager . voiture . largeur:
  formule: 2.7 m
  description: |
    Nous prenons les dimensions conseill√©es ici pour un parking standard https://parkinggarage.fr/dimension-standard-longueur-largeur-hauteur-parking-box-garage-voiture/
volume passager . voiture . longueur:
  formule: 6 m
  description: |
    Nous prenons la longueur d√©finie ici https://parkinggarage.fr/dimension-standard-longueur-largeur-hauteur-parking-box-garage-voiture, avec une majoration moins importante que la largeur, car elle est dynamique (la largeur est fix√©e par des bornes au sol) et ne n√©cessite pas d'accomoder deux porti√®res ouvertes en concurrence.

volume utile:
  question: Quel est le volume utile du bateau ?
  description: |
    On appelle ici volume utile la somme de toutes les surfaces qui ne sont pas l'infrastructure elle-m√™me du bateau, sa s√©curit√©, son √©quipage, etc.

    > Le calcul des diff√©rentes surfaces est isssu d'[un dessin SVG](https://futur.eco/ferry/surface-mega-express-four) sur un plan des ponts du navire, qui nous permet ensuite d'en d√©duire les volumes
  unit√©: m3
  formule:
    somme:
      - volume garage
      - surface . cabines * hauteur pont bas
      - surface . si√®ges * hauteur pont bas
      - surface . loisirs * hauteur pont bas
      - volume communs

volume communs: hauteur pont bas * surface . communs

volume garage: hauteur moyenne garage * surface . garage

surface . communs:
  inject√©: oui
  question: Quelle est la surface des zones communes √† tous les passagers ?
  description: |
    Cela inclut les escaliers, des places assises en salon hors bar ou restaurant, les couloirs int√©rieurs. Par convention, on n'inclut pas les surfaces ext√©rieures non couvertes, sauf les espaces de loisir √©vidents : la piscine et les bars ext√©rieurs.
  par d√©faut: 1466

surface . loisirs:
  inject√©: oui
  question: Quelle est la surface d√©di√©e aux loisirs ?
  description: Restaurants, bars, salons, jeux, commerces, piscines, etc.
  par d√©faut: 4762

hauteur moyenne garage:
  formule: (surface . garage . bas * hauteur pont bas + surface . garage . haut * hauteur pont haut) / surface . garage

surface . garage . bas:
  inject√©: oui
  question: Quelle est la surface de garage bas du bateau ?
  par d√©faut: 2334

surface . garage . haut:
  inject√©: oui
  question: Quelle est la surface de garage haut du bateau ?
  par d√©faut: 11881

surface . garage: bas + haut

surface . cabines:
  inject√©: oui
  question: Quelle est la surface totale des cabines ?
  par d√©faut: 7356

surface . si√®ges:
  inject√©: oui
  question: Quelle est la surface totale des si√®ges ?
  par d√©faut: 1095

volume passager . cabine partag√©e:
  applicable si: billet cabine
  formule: (cabines n√©cessaires * cabine) / groupe

hauteur pont bas:
  formule: 2.7m

hauteur pont haut:
  formule: hauteur pont bas * 2
  note: Nous simplifions pour l'instant ces donn√©es qui pourront √™tre am√©lior√©es dans un second temps.

volume passager . cabine:
  formule: surface . cabine * hauteur pont bas
  unit√©: m3

surface:

surface . cabine:
  formule: cabines / cabine . nombre
surface . si√®ge:
  formule: si√®ges / si√®ge . nombre

km par mille nautique: 1.852 km/mn

billet cabine: cabine

si√®ge:
si√®ge . nombre:
  inject√©: oui
  question: Quel est le nombre total de si√®ges passager ?
  par d√©faut: 281

cabine . nombre:
  inject√©: oui
  question: Quel est le nombre total de cabines passager ?
  par d√©faut: 255

cabine:
  ic√¥nes: üõå
  question: Avez-vous pris une cabine (plut√¥t qu'un simple si√®ge) ?
  description: Sans surprise, voyager en cabine apporte du confort mais en contrepartie du poids embarqu√©.
  note: Il existe aussi des cabines partag√©es (comme dans les trains de nuit), nous pourrons les ajouter par la suite comme une option possible.
  r√©f√©rences:
    corsica-ferries: https://www.corsica-ferries.fr/ferries/traversee-ferry.html
  par d√©faut: oui

cabines n√©cessaires:
  description: On part pour l'instant du principe qu'il n'y a que des cabines 4 places.
  note: |
    Ici on aimerait utiliser un m√©canisme de modulo, qui n'existe pas dans publi.codes.
  formule:
    grille:
      assiette: groupe
      tranches:
        - montant: 1
          plafond: 5
        - montant: 2
          plafond: 9
        - montant: 3
          plafond: 13
        - montant: groupe / 4

taille cabine:
  applicable si: cabine
  question: Quelle est la taille de la cabine ?
  note: |
    Variable pas int√©gr√©e encore.
  par d√©faut: "'quatre lits'"

taille cabine . deux lits:
taille cabine . quatre lits:

voiture:
  ic√¥nes: üöó
  question: Transportez-vous votre voiture ?
  description: |

    Le calcul est limit√© √† une seule voiture, on consid√®re qu'elle est partag√©e par le groupe.

    Si vous transportez un camping-car, r√©pondez oui (l'empreinte sera fortement sous-estim√©e). 

    Si vous transportez une moto, r√©pondez non (l'empreinte sera l√©g√®rement sous-estim√©e).
  par d√©faut: oui

groupe:
  ic√¥nes: üë•
  question: √Ä combien voyagez-vous ?
  par d√©faut: 2
  unit√©: personnes
  suggestions:
    seul: 1
    en couple: 2
    √† 3: 3
    √† 4: 4

groupe . avertissement simulation individuelle:
  type: notification
  s√©v√©rit√©: information
  formule: groupe > 1
  description: |
    Le nombre de personnes qui voyage est important pour le calcul,

    mais **le r√©sultat du calcul reste individuel**.

# Infra n√©cessaire aux pax mais pas au fret
# WC, escaliers, canots de sauvetage
# ces derniers peuvent-ils √™tre n√©glig√©s / personne, vu que leur but est de flotter ?
#
#

consommation de services:
  ic√¥nes: üçΩÔ∏è
  question: Utilisez vous les services accessoires du ferry (bar, restaurant, piscine, etc.) ?
  par d√©faut: oui

passagers:
  titre: Passagers moyens
  formule: 600
  description: |
    Pour certaines services en commun, nous avons besoin de r√©partir le poids par passager.

    C'est la valeur du Mega Express Four https://fr.wikipedia.org/wiki/Mega_Express_Four mais en ordre de grandeur de la valeur moyenne, obtenu gr√¢ce aux d√©clarations Thetis-MRV expos√©es sur https://www.greenferries.org/ships/mega-express-four-9086590 en 2018-2019, donc pr√©-pand√©mie.

  note: |
    Ce param√®tre est tr√®s d√©terminant. Le nombre de passagers max du Mega Express Four est de 1880 d'apr√®s Wikipedia. Il circule donc √† 1/3 de son remplissage, ce qui est tr√®s faible si on compare au TGV ou aux avions de ligne.
